# 融通金价格查看器

一个使用Python编写的桌面应用程序，在窗体内嵌显示股票行情网页。专为Python 3.13和Windows系统设计。

## 功能特性

- ✅ **内嵌网页显示**：在应用程序窗口内直接显示 `https://i.jzj9999.com/quoteh5/` 网页内容，无需跳转外部浏览器
- ✅ **简洁窗口设计**：移除最大化、最小化按钮，只保留关闭按钮
- ✅ **自适应窗口**：默认尺寸400×600像素，支持通过边缘拖拽调整大小
- ✅ **智能设置保存**：窗口大小和裁剪设置自动保存，下次启动时恢复
- ✅ **网页内容裁剪**：自动隐藏网页顶部182px和底部88px区域，聚焦核心内容
- ✅ **任务栏集成**：窗口在任务栏正常显示，无系统托盘图标
- ✅ **直接退出**：点击关闭按钮立即退出，无需确认对话框
- ✅ **居中显示**：启动时自动居中显示在屏幕中央

## 系统要求

- **操作系统**：Windows 10 或更高版本（使用Windows API进行窗口定制）
- **Python版本**：Python 3.13（向下兼容至Python 3.10）
- **依赖库**：pywebview

## 安装步骤

### 1. 安装Python
确保已安装Python 3.10或更高版本，推荐使用Python 3.13。

### 2. 安装依赖库
```bash
pip install pywebview
```

### 3. 运行程序
```bash
python stock_viewer.py
```

## 使用方法

### 基本使用
1. 运行程序后，窗口将自动打开并显示股票行情页面
2. 窗口默认居中显示，尺寸为400×600像素
3. 网页内容已自动裁剪（顶部182px和底部88px不显示）

### 窗口操作
- **调整大小**：拖动窗口边缘可自由调整窗口尺寸
- **移动窗口**：拖动标题栏可移动窗口位置
- **关闭程序**：点击右上角关闭按钮直接退出程序

### 设置保存
- 窗口大小调整后自动保存
- 裁剪设置自动保存
- 配置文件位置：`C:\Users\[用户名]\.stock_viewer_config.json`

## 配置文件说明

程序会在用户目录下创建配置文件，保存以下设置：

```json
{
  "width": 400,
  "height": 600,
  "crop_top": 182,
  "crop_bottom": 88
}
```

- **width/height**：窗口宽度和高度（像素）
- **crop_top**：网页顶部隐藏像素数
- **crop_bottom**：网页底部隐藏像素数

## 技术实现

### 核心技术
1. **pywebview**：用于在Python窗口中内嵌显示网页内容
2. **Windows API**：用于移除窗口的最大化、最小化按钮
3. **CSS注入**：通过JavaScript注入CSS样式裁剪网页内容
4. **JSON配置**：使用JSON格式保存和恢复用户设置

### 代码结构
```
stock_viewer.py
├── StockViewer类
│   ├── __init__()        # 初始化设置
│   ├── create_window()   # 创建主窗口
│   ├── remove_window_buttons()  # 移除窗口按钮
│   ├── center_window()   # 窗口居中
│   ├── inject_css()      # 注入CSS样式
│   ├── save_settings()   # 保存设置
│   ├── load_settings()   # 加载设置
│   └── run()            # 运行应用程序
└── main()函数            # 程序入口
```

## 常见问题

### Q1: 程序启动时显示错误 "ModuleNotFoundError: No module named 'webview'"
**解决方法**：运行 `pip install pywebview` 安装依赖库。

### Q2: 窗口无法调整大小
**解决方法**：确保使用的是Windows系统，程序依赖Windows API进行窗口管理。

### Q3: 网页内容显示不全
**解决方法**：检查网络连接，确保可以访问 `https://i.jzj9999.com/quoteh5/`。

### Q4: 关闭时出现确认对话框
**解决方法**：更新到最新版本，已修复此问题。

### Q5: 窗口没有居中显示
**解决方法**：重新启动程序，窗口会在创建后自动居中。

## 版本历史

### v1.0 (2025-12-12)
- 初始版本发布
- 实现窗体内嵌显示网页
- 移除最大化最小化按钮
- 支持窗口大小调整和设置保存
- 添加网页内容裁剪功能
- 修复关闭确认对话框问题
- 添加窗口自动居中功能

## 开发者说明

### 项目背景
本项目为满足特定需求开发：
- 需要在桌面窗体内显示股票行情
- 要求无最大化最小化按钮
- 需要保存窗口大小设置
- 要求隐藏网页特定区域

### 技术选型理由
1. **pywebview**：轻量级、跨平台（虽然本版本专为Windows优化）
2. **Python 3.13**：使用最新Python版本确保长期兼容性
3. **Windows API**：提供精细的窗口控制能力

### 扩展可能性
- 添加多个股票页面切换
- 增加自定义裁剪设置界面
- 支持多显示器布局
- 添加数据刷新定时器

## 许可证

本项目为开源项目，遵循MIT许可证。

## 联系支持

如有问题或建议，请检查以下资源：
1. 查看本README文件
2. 检查Python和依赖库版本
3. 确认网络连接正常
4. 查看配置文件是否正确

---

*最后更新：2025年12月12日*  
*适用版本：v1.0*
